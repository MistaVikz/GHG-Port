2025-01-08 13:10:57 ERROR: An unexpected error occurred: Cannot cast ufunc 'cholesky_lo' input from dtype('O') to dtype('float64') with casting rule 'same_kind'
2025-01-08 13:10:58 ERROR: Yearly portfolio DataFrame:    project_id                            project_name  contract_duration    country  ... expected_value_percentage_2018 expected_value_percentage_2019  expected_value_percentage_2020 expected_value_percentage_2021
0           2    Renewable Solutions Sustainable Park                  1        USA  ...                            NaN                            NaN                             NaN                            NaN
1           3       Clean Power Co. Site D Geothermal                  9     France  ...                       0.849413                       0.855340                        0.866965                       0.876457
2           4         Site A Recycling GreenTech Inc.                  9  Indonesia  ...                       0.549116                       0.585219                             NaN                            NaN
3           5  Eco-Friendly Sustainable Futures North                  3     Mexico  ...                            NaN                            NaN                             NaN                            NaN
4           6                   Wind Pure Planet East                  4      India  ...                            NaN                            NaN                             NaN                            NaN

[5 rows x 89 columns]
2025-01-08 13:10:58 ERROR: Project correlation matrix: [[1.0 0.12334574009890073 0.24874684758940444 0.12089546071229304
  -0.14774988892555743 -0.5096511377563476 0.4588227735290527
  -0.1839301273048594 -0.44386529610824005 -0.13290122922357486
  0.0020709927789564755 0.23747506138525662 -0.15305042740885458
  0.3381101431897971 -0.21797484375690349 0.000822426912537504
  0.003947059183689954 0.000822426912537504 -0.8532568945159912
  -0.3197834267276651 0.3346328770601897 0.3296434065600831
  -0.6287710249537471 -0.23739806402809652]
 [0.12334574009890073 1.0 0.09152461450003355 -0.09873578044966994
  0.40925047166331546 -0.24201650755310058 0.17183323763979072
  0.03187256115211565 0.47177727221479665 -0.05948319878222921
  -0.6244487299194336 -0.14694219724279126 0.0260729428715106
  0.34213402624877426 0.29114286763763425 -0.07371177894480954
  0.25645124085747534 -0.07371177894480954 0.023536362245326042
  0.11155690335647503 -0.3953245985353508 -0.5439355387091044
  0.04686196636729076 0.05149282520236195]
 [0.24874684758940444 0.09152461450003355 1.0 0.6248176042895491
  0.5881404030626979 -0.24441768491535956 -0.15235533346222244
  0.1470400558242798 0.32530441612982736 0.7825597987899781
  -0.6164476910919038 0.45886623915135055 0.09495453688734554
  0.23296700459545402 -0.0037884193077363524 -0.2999178835376998
  0.7679238546384565 -0.2999178835376998 0.1251082025794997
  -0.19652736383787076 0.1437165735493718 -0.3627226237898615
  -0.1912987278730586 0.09162731708505842]
 [0.12089546071229304 -0.09873578044966994 0.6248176042895491 1.0
  -0.10733303181734502 0.060340790646537495 0.32806943825682106
  0.28031171712541686 -0.018340810796940193 -0.5791372407456353
  0.04414303576394016 -0.1631775252860709 0.09035278203029659
  0.6063102371772996 -0.31484464054137823 0.10399782619339501
  -0.13292480716779412 0.10399782619339501 0.00051768054794618
  -0.14229030712826077 0.0968487725982666 0.0029509860044523986
  0.0009558867015496399 -0.15069527830092713]
 [-0.14774988892555743 0.40925047166331546 0.5881404030626979
  -0.10733303181734502 1.0 0.1766050638699451 0.22930217997134403
  0.042433522082762604 -0.1232067499848856 0.7515603767166138
  -0.17823863066575743 -0.4831149114837647 0.444161904604189
  -0.2007293809230052 0.13411207195486238 -0.2173378420457485
  -0.05708144317737865 -0.2173378420457485 -0.06508035853763974
  0.7211795316467285 -0.01948487252411471 0.025702203943526708
  0.05697325758663649 -0.0070379046554453215]
 [-0.5096511377563476 -0.24201650755310058 -0.24441768491535956
  0.060340790646537495 0.1766050638699451 1.0 -0.7099982036819458
  -0.0851137007857378 0.6868574984485204 0.15885671957596767
  -0.004060579704284668 -0.06340962747289072 0.08933334594678652
  -0.5232026408732909 -0.07046042915001496 -0.00047844664328269935
  0.0016690175257022255 -0.00047844664328269935 -0.09724552767181396
  0.3822337549642068 0.24159145640544719 -0.7919132363858498
  -0.0716606822615066 -0.10985615467330692]
 [0.4588227735290527 0.17183323763979072 -0.15235533346222244
  0.32806943825682106 0.22930217997134403 -0.7099982036819458 1.0
  -0.046870840482509696 -0.9674036039581299 0.2062578841608936
  0.0028847183557328673 -0.22763370044885992 -0.288150187605763
  0.7369083629379273 -0.12029753522975031 0.00154750723868599
  -0.0008574021362310068 0.00154750723868599 0.8901454673538208
  0.49628868339971427 -0.19541773860703163 -0.44988968646074773
  0.65595501207149 -0.06049626994484672]
 [-0.1839301273048594 0.03187256115211565 0.1470400558242798
  0.28031171712541686 0.042433522082762604 -0.0851137007857378
  -0.046870840482509696 1.0 0.10007934582756914 0.05646030767059326
  -0.2146669003293741 0.29251917718949266 0.062375019940961035
  0.07167209602275446 0.010254027471549102 -0.19701268727997703
  -0.3679897270312839 -0.19701268727997703 0.30485808939522735
  -0.014177941412552604 0.8222146533358082 0.4526911784502115
  -0.46615184363360845 0.6231437192687989]
 [-0.44386529610824005 0.47177727221479665 0.32530441612982736
  -0.018340810796940193 -0.1232067499848856 0.6868574984485204
  -0.9674036039581299 0.10007934582756914 1.0 -0.44038810292147196
  -0.3845811120350479 0.12231331982448776 -0.06544329544862851
  -0.9949876798858642 -0.33028623412520836 -0.2062462636930579
  0.11448031656391575 -0.2062462636930579 -0.8611288559059435
  0.11271682133599623 0.010926566472508307 0.46505014760589597
  -0.8856826684800839 0.12578808375903602]
 [-0.13290122922357486 -0.05948319878222921 0.7825597987899781
  -0.5791372407456353 0.7515603767166138 0.15885671957596767
  0.2062578841608936 0.05646030767059326 -0.44038810292147196 1.0
  0.4006512221341179 -0.36308929331661693 -0.15466889783098484
  -0.3153836061488821 -0.019491974861123 0.488539127119952
  0.12831193429419127 0.488539127119952 -0.05853981619034446
  -0.25113458769226077 -0.10513819715802444 0.09186640741211502
  0.08951496862673278 0.03518320650988724]
 [0.0020709927789564755 -0.6244487299194336 -0.6164476910919038
  0.04414303576394016 -0.17823863066575743 -0.004060579704284668
  0.0028847183557328673 -0.2146669003293741 -0.3845811120350479
  0.4006512221341179 1.0 0.06399888642109172 0.10188733074574227
  -0.3441243319156346 -0.1818024606145602 0.11804537637329102
  -0.41068096296691897 0.11804537637329102 0.00039597452310399697
  0.43594939563866114 0.1767383478198806 0.44340664625628073
  -0.04713284668484366 0.048371423224014304]
 [0.23747506138525662 -0.14694219724279126 0.45886623915135055
  -0.1631775252860709 -0.4831149114837647 -0.06340962747289072
  -0.22763370044885992 0.29251917718949266 0.12231331982448776
  -0.36308929331661693 0.06399888642109172 1.0 -0.14273987383307687
  0.19927254381893786 0.6552955665934829 0.06984761619222266
  -0.005762794861593396 0.06984761619222266 0.06394698834397414
  -0.3484118236590323 0.031426254717078134 0.16547457203106117
  -0.05597735388543615 -0.04852327944786086]
 [-0.15305042740885458 0.0260729428715106 0.09495453688734554
  0.09035278203029659 0.444161904604189 0.08933334594678652
  -0.288150187605763 0.062375019940961035 -0.06544329544862851
  -0.15466889783098484 0.10188733074574227 -0.14273987383307687 1.0
  -0.25959470376653576 -0.09584814727213345 0.8631198869476319
  0.5068186878212683 0.8631198869476319 0.0484186284703608
  0.6158830390701294 0.1949234624502932 -0.08823637873439086
  0.04362049170470325 0.0797890913816158]
 [0.3381101431897971 0.34213402624877426 0.23296700459545402
  0.6063102371772996 -0.2007293809230052 -0.5232026408732909
  0.7369083629379273 0.07167209602275446 -0.9949876798858642
  -0.3153836061488821 -0.3441243319156346 0.19927254381893786
  -0.25959470376653576 1.0 -0.23952391381581353 -0.18454972624021795
  0.10243746695258235 -0.18454972624021795 0.65595501207149
  0.4471070886935447 -0.3611559188567501 -0.4627176374584369
  0.8901454673538208 -0.06275678484842931]
 [-0.21797484375690349 0.29114286763763425 -0.0037884193077363524
  -0.31484464054137823 0.13411207195486238 -0.07046042915001496
  -0.12029753522975031 0.010254027471549102 -0.33028623412520836
  -0.019491974861123 -0.1818024606145602 0.6552955665934829
  -0.09584814727213345 -0.23952391381581353 1.0 0.2709937311416322
  -0.44636973626495297 0.2709937311416322 -0.055697681086227
  0.03655787500639715 -0.21411970415885864 -0.3436311568754153
  -0.11089994955315521 0.016565833327123552]
 [0.000822426912537504 -0.07371177894480954 -0.2999178835376998
  0.10399782619339501 -0.2173378420457485 -0.00047844664328269935
  0.00154750723868599 -0.19701268727997703 -0.2062462636930579
  0.488539127119952 0.11804537637329102 0.06984761619222266
  0.8631198869476319 -0.18454972624021795 0.2709937311416322 1.0
  0.5871943698654175 1.000001 -0.00025885738088252217 0.531580420053248
  0.22436090738770784 -0.27807851471800155 0.031010792363789758
  0.04439345653418311]
 [0.003947059183689954 0.25645124085747534 0.7679238546384565
  -0.13292480716779412 -0.05708144317737865 0.0016690175257022255
  -0.0008574021362310068 -0.3679897270312839 0.11448031656391575
  0.12831193429419127 -0.41068096296691897 -0.005762794861593396
  0.5068186878212683 0.10243746695258235 -0.44636973626495297
  0.5871943698654175 1.0 0.5871943698654175 0.003338371382770016
  0.13961641229278396 -0.05242175923811235 0.488851533172922
  -0.3982605127924305 0.08291915954646609]
 [0.000822426912537504 -0.07371177894480954 -0.2999178835376998
  0.10399782619339501 -0.2173378420457485 -0.00047844664328269935
  0.00154750723868599 -0.19701268727997703 -0.2062462636930579
  0.488539127119952 0.11804537637329102 0.06984761619222266
  0.8631198869476319 -0.18454972624021795 0.2709937311416322 1.000001
  0.5871943698654175 1.0 -0.00025885738088252217 0.531580420053248
  0.22436090738770784 -0.27807851471800155 0.031010792363789758
  0.04439345653418311]
 [-0.8532568945159912 0.023536362245326042 0.1251082025794997
  0.00051768054794618 -0.06508035853763974 -0.09724552767181396
  0.8901454673538208 0.30485808939522735 -0.8611288559059435
  -0.05853981619034446 0.00039597452310399697 0.06394698834397414
  0.0484186284703608 0.65595501207149 -0.055697681086227
  -0.00025885738088252217 0.003338371382770016 -0.00025885738088252217
  1.0 -0.1408577459741284 -0.012303250879537904 0.2992481378287007
  0.7369083629379273 0.3934786497335406]
 [-0.3197834267276651 0.11155690335647503 -0.19652736383787076
  -0.14229030712826077 0.7211795316467285 0.3822337549642068
  0.49628868339971427 -0.014177941412552604 0.11271682133599623
  -0.25113458769226077 0.43594939563866114 -0.3484118236590323
  0.6158830390701294 0.4471070886935447 0.03655787500639715
  0.531580420053248 0.13961641229278396 0.531580420053248
  -0.1408577459741284 1.0 -0.025831163620847836 -0.023511581896625305
  -0.12689879033802956 -0.01813653024400455]
 [0.3346328770601897 -0.3953245985353508 0.1437165735493718
  0.0968487725982666 -0.01948487252411471 0.24159145640544719
  -0.19541773860703163 0.8222146533358082 0.010926566472508307
  -0.10513819715802444 0.1767383478198806 0.031426254717078134
  0.1949234624502932 -0.3611559188567501 -0.21411970415885864
  0.22436090738770784 -0.05242175923811235 0.22436090738770784
  -0.012303250879537904 -0.025831163620847836 1.0 0.007164729640069505
  -0.022738709447364475 -0.4420246877673268]
 [0.3296434065600831 -0.5439355387091044 -0.3627226237898615
  0.0029509860044523986 0.025702203943526708 -0.7919132363858498
  -0.44988968646074773 0.4526911784502115 0.46505014760589597
  0.09186640741211502 0.44340664625628073 0.16547457203106117
  -0.08823637873439086 -0.4627176374584369 -0.3436311568754153
  -0.27807851471800155 0.488851533172922 -0.27807851471800155
  0.2992481378287007 -0.023511581896625305 0.007164729640069505 1.0
  0.307780716376757 0.5689810018449489]
 [-0.6287710249537471 0.04686196636729076 -0.1912987278730586
  0.0009558867015496399 0.05697325758663649 -0.0716606822615066
  0.65595501207149 -0.46615184363360845 -0.8856826684800839
  0.08951496862673278 -0.04713284668484366 -0.05597735388543615
  0.04362049170470325 0.8901454673538208 -0.11089994955315521
  0.031010792363789758 -0.3982605127924305 0.031010792363789758
  0.7369083629379273 -0.12689879033802956 -0.022738709447364475
  0.307780716376757 1.0 0.40818116593402715]
 [-0.23739806402809652 0.05149282520236195 0.09162731708505842
  -0.15069527830092713 -0.0070379046554453215 -0.10985615467330692
  -0.06049626994484672 0.6231437192687989 0.12578808375903602
  0.03518320650988724 0.048371423224014304 -0.04852327944786086
  0.0797890913816158 -0.06275678484842931 0.016565833327123552
  0.04439345653418311 0.08291915954646609 0.04439345653418311
  0.3934786497335406 -0.01813653024400455 -0.4420246877673268
  0.5689810018449489 0.40818116593402715 1.0]]
2025-01-08 13:10:58 ERROR: An error occurred
Traceback (most recent call last):
  File "c:\Users\markd\OneDrive\Desktop\Data\GHG Portfolio Risk\GHG_Port.py", line 49, in main
    results = run_portfolio_simulation(yearly_portfolio_df, project_correlation_matrix)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\markd\OneDrive\Desktop\Data\GHG Portfolio Risk\utils\risk_calc.py", line 329, in run_portfolio_simulation
    cholesky_factors = np.linalg.cholesky(active_project_correlation_matrix)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Users\markd\miniconda3\envs\floofyboots\Lib\site-packages\numpy\linalg\linalg.py", line 779, in cholesky
    r = gufunc(a, signature=signature, extobj=extobj)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
numpy.core._exceptions._UFuncInputCastingError: Cannot cast ufunc 'cholesky_lo' input from dtype('O') to dtype('float64') with casting rule 'same_kind'
2025-01-11 12:10:03 ERROR: An error occurred while writing to the Excel file: No module named 'xlsxwriter'
2025-01-11 12:12:10 ERROR: An error occurred while writing to the Excel file: 'list' object is not callable
2025-01-11 12:13:19 ERROR: An error occurred while writing to the Excel file: No module named 'xlsxwriter'
